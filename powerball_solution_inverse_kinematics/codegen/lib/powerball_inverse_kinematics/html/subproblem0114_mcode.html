<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S92T2U1276">theta</span>]=subproblem0(<span class="var type1" id="S93T5U1279">p</span>,<span class="var type1" id="S94T5U1280">q</span>,<span class="var type1" id="S95T5U1281">k</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="comment">% [theta]=subproblem0(p,q,k)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="comment">% 1 unique solution</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo" id="T5:U5"><span class="var type1" id="S96T5U1284">pp</span>=<span class="mxinfo" id="T5:U7"><span class="var type1" id="S93T5U1286">p</span>/<span class="mxinfo" id="T2:U9">norm(<span class="var type1" id="S93T5U1289">p</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T5:U11"><span class="var type1" id="S98T5U1292">qp</span>=<span class="mxinfo" id="T5:U13"><span class="var type1" id="S94T5U1294">q</span>/<span class="mxinfo" id="T2:U15">norm(<span class="var type1" id="S94T5U1297">q</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo" id="T2:U17"><span class="var type1" id="S92T2U1300">theta</span>=<span class="mxinfo" id="T2:U19"><span class="mxinfo" id="T2:U20">2</span>*<span class="mxinfo" id="T2:U21">atan2(<span class="mxinfo" id="T2:U22">norm(<span class="mxinfo" id="T5:U23"><span class="var type1" id="S96T5U1308">pp</span>-<span class="var type1" id="S98T5U1309">qp</span></span>)</span>,<span class="mxinfo" id="T2:U26">norm(<span class="mxinfo" id="T5:U27"><span class="var type1" id="S96T5U1313">pp</span>+<span class="var type1" id="S98T5U1314">qp</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U30"><span class="mxinfo" id="T2:U31"><span class="mxinfo" id="T16:U32"><span class="var type1" id="S95T5U1320">k</span>'</span>*(<span class="mxinfo" id="T5:U34">cross(<span class="var type1" id="S93T5U1324">p</span>,<span class="var type1" id="S94T5U1325">q</span>)</span>)</span>&lt;<span class="mxinfo" id="T2:U37">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">    <span class="mxinfo" id="T2:U38"><span class="var type1" id="S92T2U1329">theta</span>=<span class="mxinfo" id="T2:U40">-<span class="var type1" id="S92T2U1331">theta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
