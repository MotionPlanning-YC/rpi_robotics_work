<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S57T31U908">theta1</span>,<span class="var type1" id="S58T31U909">theta2</span>]=subproblem2(<span class="mxinfo" id="T5:U3"><span class="var type1" id="S59T5U912">k1</span></span>,<span class="mxinfo" id="T5:U5"><span class="var type1" id="S60T5U913">k2</span></span>,<span class="var type1" id="S61T5U914">p</span>,<span class="var type1" id="S62T5U915">q</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T2:U9"><span class="var type1" id="S63T2U918">k12</span>=<span class="mxinfo" id="T2:U11"><span class="mxinfo" id="T16:U12"><span class="var type1" id="S59T5U921">k1</span>'</span>*<span class="mxinfo" id="T5:U14"><span class="var type1" id="S60T5U922">k2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T2:U16"><span class="var type1" id="S64T2U925">pk</span>=<span class="mxinfo" id="T2:U18"><span class="mxinfo" id="T16:U19"><span class="var type1" id="S61T5U928">p</span>'</span>*<span class="mxinfo" id="T5:U21"><span class="var type1" id="S60T5U929">k2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="mxinfo" id="T2:U23"><span class="var type1" id="S65T2U932">qk</span>=<span class="mxinfo" id="T2:U25"><span class="mxinfo" id="T16:U26"><span class="var type1" id="S62T5U935">q</span>'</span>*<span class="mxinfo" id="T5:U28"><span class="var type1" id="S59T5U936">k1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="comment">% check if solution exists</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U30"><span class="mxinfo" id="T2:U31">abs(<span class="mxinfo" id="T2:U32"><span class="mxinfo" id="T2:U33"><span class="var type1" id="S63T2U944">k12</span>^2</span>-<span class="mxinfo" id="T2:U35">1</span></span>)</span>&lt;<span class="mxinfo" id="T2:U36">eps</span></span>;<span class="mxinfo" id="T31:U37"><span class="var type1" id="S57T31U951">theta1</span>=<span class="mxinfo" id="T19:U39">[]</span></span>;<span class="mxinfo" id="T31:U40"><span class="var type1" id="S58T31U956">theta2</span>=<span class="mxinfo" id="T19:U42">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo" id="T40:U43"><span class="autoExtrinsicFcn" id="F201N2:B961">disp</span>(<span class="mxinfo" id="T41:U44"><span class="string">'no solution (***1***)'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="mxinfo" id="T18:U45"><span class="var type1" id="S69T18U966">a</span>=<span class="mxinfo" id="T18:U47"><span class="mxinfo" id="T18:U48"><span class="mxinfo" id="T17:U49">[<span class="mxinfo" id="T21:U50"><span class="var type1" id="S63T2U971">k12</span> <span class="mxinfo" id="T2:U52">-<span class="mxinfo" id="T2:U53">1</span></span></span>;<span class="mxinfo" id="T21:U54"><span class="mxinfo" id="T2:U55">-<span class="mxinfo" id="T2:U56">1</span></span> <span class="var type1" id="S63T2U977">k12</span></span>]</span>*<span class="mxinfo" id="T18:U58">[<span class="var type1" id="S64T2U980">pk</span>;<span class="var type1" id="S65T2U982">qk</span>]</span></span>/(<span class="mxinfo" id="T2:U61"><span class="mxinfo" id="T2:U62"><span class="var type1" id="S63T2U986">k12</span>^2</span>-<span class="mxinfo" id="T2:U64">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="mxinfo" id="T2:U65"><span class="var type1" id="S70T2U991">bb</span>=(<span class="mxinfo" id="T2:U67"><span class="mxinfo" id="T2:U68"><span class="mxinfo" id="T2:U69"><span class="mxinfo" id="T2:U70">norm(<span class="var type1" id="S61T5U998">p</span>)</span>^2</span>-<span class="mxinfo" id="T2:U72"><span class="mxinfo" id="T2:U73">norm(<span class="var type1" id="S69T18U1003">a</span>)</span>^2</span></span>-<span class="mxinfo" id="T2:U75"><span class="mxinfo" id="T2:U76"><span class="mxinfo" id="T2:U77"><span class="mxinfo" id="T2:U78">2</span>*<span class="mxinfo" id="T2:U79"><span class="var type1" id="S69T18U1010">a</span>(<span class="mxinfo" id="T2:U81">1</span>)</span></span>*<span class="mxinfo" id="T2:U82"><span class="var type1" id="S69T18U1013">a</span>(<span class="mxinfo" id="T2:U84">2</span>)</span></span>*<span class="var type1" id="S63T2U1015">k12</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U86"><span class="mxinfo" id="T2:U87">abs(<span class="var type1" id="S70T2U1021">bb</span>)</span>&lt;<span class="mxinfo" id="T2:U89">eps</span></span>;<span class="mxinfo" id="T2:U90"><span class="var type1" id="S70T2U1026">bb</span>=<span class="mxinfo" id="T2:U92">0</span></span>;<span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U93"><span class="var type1" id="S70T2U1031">bb</span>&lt;<span class="mxinfo" id="T2:U95">0</span></span>;<span class="mxinfo" id="T31:U96"><span class="var type1" id="S57T31U1035">theta1</span>=<span class="mxinfo" id="T21:U98">[<span class="mxinfo" id="T2:U99">NaN</span> <span class="mxinfo" id="T2:U100">NaN</span>]</span></span>;<span class="mxinfo" id="T31:U101"><span class="var type1" id="S58T31U1044">theta2</span>=<span class="mxinfo" id="T21:U103">[<span class="mxinfo" id="T2:U104">NaN</span> <span class="mxinfo" id="T2:U105">NaN</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo" id="T40:U106"><span class="autoExtrinsicFcn" id="F202N2:B1053">disp</span>(<span class="mxinfo" id="T41:U107"><span class="string">'no solution (***2***)'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    <span class="keyword">return</span>;<span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="comment">% check if there is only 1 solution</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"><span class="mxinfo" id="T2:U108"><span class="var type1" id="S73T2U1058">gamma</span>=<span class="mxinfo" id="T2:U110"><span class="mxinfo" id="T2:U111">sqrt(<span class="var type1" id="S70T2U1062">bb</span>)</span>/<span class="mxinfo" id="T2:U113">norm(cross(<span class="var type1" id="S59T5U1067">k1</span>,<span class="var type1" id="S60T5U1068">k2</span>))</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U116"><span class="mxinfo" id="T2:U117">abs(<span class="var type1" id="S73T2U1074">gamma</span>)</span>&lt;<span class="mxinfo" id="T2:U119">eps</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">    <span class="mxinfo" id="T5:U120"><span class="var type1" id="S76T5U1079">c1</span>=<span class="mxinfo" id="T5:U122"><span class="mxinfo" id="T4:U123">[<span class="var type1" id="S59T5U1083">k1</span> <span class="var type1" id="S60T5U1084">k2</span> cross(<span class="var type1" id="S59T5U1087">k1</span>,<span class="var type1" id="S60T5U1088">k2</span>)]</span>*<span class="mxinfo" id="T5:U128">[<span class="var type1" id="S69T18U1091">a</span>;<span class="var type1" id="S73T2U1093">gamma</span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    <span class="mxinfo" id="T21:U131"><span class="var type1" id="S58T21U1096">theta2</span>=<span class="mxinfo" id="T21:U133">[<span class="mxinfo" id="T2:U134"><span class="fcn" id="F115N6:B1100">subproblem1</span>(<span class="mxinfo" id="T5:U135"><span class="var type1" id="S60T5U1101">k2</span></span>,<span class="var type1" id="S61T5U1102">p</span>,<span class="var type1" id="S76T5U1103">c1</span>)</span> <span class="mxinfo" id="T2:U139">NaN</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo" id="T21:U140"><span class="var type1" id="S57T21U1108">theta1</span>=<span class="mxinfo" id="T21:U142">[<span class="mxinfo" id="T2:U143">-<span class="mxinfo" id="T2:U144"><span class="fcn" id="F115N6:B1113">subproblem1</span>(<span class="mxinfo" id="T5:U145"><span class="var type1" id="S59T5U1114">k1</span></span>,<span class="var type1" id="S62T5U1115">q</span>,<span class="var type1" id="S76T5U1116">c1</span>)</span></span> <span class="mxinfo" id="T2:U149">NaN</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="comment">% general case: 2 solutions</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T31:U150"><span class="var type1" id="S57T31U1121">theta1</span>=<span class="mxinfo" id="T21:U152">zeros(<span class="mxinfo" id="T2:U153">1</span>,<span class="mxinfo" id="T2:U154">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T31:U155"><span class="var type1" id="S58T31U1128">theta2</span>=<span class="mxinfo" id="T21:U157">zeros(<span class="mxinfo" id="T2:U158">1</span>,<span class="mxinfo" id="T2:U159">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T5:U160"><span class="var type1" id="S76T5U1135">c1</span>=<span class="mxinfo" id="T5:U162"><span class="mxinfo" id="T4:U163">[<span class="var type1" id="S59T5U1139">k1</span> <span class="var type1" id="S60T5U1140">k2</span> cross(<span class="var type1" id="S59T5U1143">k1</span>,<span class="var type1" id="S60T5U1144">k2</span>)]</span>*<span class="mxinfo" id="T5:U168">[<span class="var type1" id="S69T18U1147">a</span>;<span class="var type1" id="S73T2U1149">gamma</span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo" id="T5:U171"><span class="var type1" id="S79T5U1152">c2</span>=<span class="mxinfo" id="T5:U173"><span class="mxinfo" id="T4:U174">[<span class="var type1" id="S59T5U1156">k1</span> <span class="var type1" id="S60T5U1157">k2</span> cross(<span class="var type1" id="S59T5U1160">k1</span>,<span class="var type1" id="S60T5U1161">k2</span>)]</span>*<span class="mxinfo" id="T5:U179">[<span class="var type1" id="S69T18U1164">a</span>;<span class="mxinfo" id="T2:U181">-<span class="var type1" id="S73T2U1167">gamma</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo" id="T2:U183"><span class="mxinfo" id="T2:U184"><span class="var type1" id="S58T31U1171">theta2</span>(<span class="mxinfo" id="T2:U186">1</span>)</span>=<span class="mxinfo" id="T2:U187"><span class="fcn" id="F115N6:B1174">subproblem1</span>(<span class="mxinfo" id="T5:U188"><span class="var type1" id="S60T5U1175">k2</span></span>,<span class="var type1" id="S61T5U1176">p</span>,<span class="var type1" id="S76T5U1177">c1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo" id="T2:U192"><span class="mxinfo" id="T2:U193"><span class="var type1" id="S58T31U1181">theta2</span>(<span class="mxinfo" id="T2:U195">2</span>)</span>=<span class="mxinfo" id="T2:U196"><span class="fcn" id="F115N6:B1184">subproblem1</span>(<span class="mxinfo" id="T5:U197"><span class="var type1" id="S60T5U1185">k2</span></span>,<span class="var type1" id="S61T5U1186">p</span>,<span class="var type1" id="S79T5U1187">c2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo" id="T2:U201"><span class="mxinfo" id="T2:U202"><span class="var type1" id="S57T31U1191">theta1</span>(<span class="mxinfo" id="T2:U204">1</span>)</span>=<span class="mxinfo" id="T2:U205">-<span class="mxinfo" id="T2:U206"><span class="fcn" id="F115N6:B1195">subproblem1</span>(<span class="mxinfo" id="T5:U207"><span class="var type1" id="S59T5U1196">k1</span></span>,<span class="var type1" id="S62T5U1197">q</span>,<span class="var type1" id="S76T5U1198">c1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo" id="T2:U211"><span class="mxinfo" id="T2:U212"><span class="var type1" id="S57T31U1202">theta1</span>(<span class="mxinfo" id="T2:U214">2</span>)</span>=<span class="mxinfo" id="T2:U215">-<span class="mxinfo" id="T2:U216"><span class="fcn" id="F115N6:B1206">subproblem1</span>(<span class="mxinfo" id="T5:U217"><span class="var type1" id="S59T5U1207">k1</span></span>,<span class="var type1" id="S62T5U1208">q</span>,<span class="var type1" id="S79T5U1209">c2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"></span></span>
</pre>
